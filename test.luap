
local ffi = require("ffi")

ffi.cdef[[
    typedef struct {
        int x;
        int y;
    } Point;
]]

#define Point(x, y) = ffi.new("Point", {x=x, y=y})

#define Array(type, size) = ffi.new(type .. "[" .. size .. "]")

#define iadd(var, value) = var = var + value

#define ARRAY_SIZE = 10000

local arr = Array("int", ARRAY_SIZE)
for i = 0, ARRAY_SIZE do
    arr[i] = math.random(1, 1000)
end
local sum = 0
for i = 0, ARRAY_SIZE do
    iadd(sum, arr[i])
end

print(sum)